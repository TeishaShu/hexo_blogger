---
title: 自己裝 Webpack
tags: Webpack
categories: Webpack
---
瀏覽器能識別的檔案是 Html、Css、JavaScript，隨著前端的發展有越來越多工具幫助更快速的開發 Ex: react、sass、es6...等，這些檔案瀏覽器無法讀，因此使用 Webpack 把所有開發資料編譯成一包瀏覽器看得懂的內容。

### 專案結構
src: 開發的檔案，不會部屬。優點是只管開發就好，編譯交給 webpack。
dist: 經過 webpack 編譯打包後的，會產出瀏覽器看得懂的 Html、Css、JavaScript，會部屬這個資料夾。
<img src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*YmNJ7Ve6PgWxX0yc7x_m5A.png" alt="">

### 安裝
1. webpack 是在 node 上運行的，可以先到 [node 官網](https://nodejs.org/en/) 下載 LTS 比較穩定的版本。
打開終端機打下面語法確定有安裝成功，可以看到安裝的版本號。
``` node -v```

2. 初始化 package.json
裡面有很多輸入的，只是練習的話 Enter 按到底。
``` npm init ```

3. 安裝相關套件
ex: webpack、css、react....。
這是的目標是安裝 html、scss、react、typescript，在下面標題「安裝相關套件」會詳細描述。

4. 增加 webpack 設定檔: webpack.config.js
詳細描述也在下面標題「webpack.config.js 說明」


### 安裝相關套件
  A. webpack
  ``` npm install webpack webpack-cli --save-dev ```



### webpack 設定檔: webpack.config.js
官網的預設項目
```
const path = require('path');
module.exports = {
  entry: './src/index.js',
  output: {
    path: path.resolve(__dirname, 'dist'),
    filename: 'bundle.js',
  },
};
```
- path = require('path'): nodejs 的套件，指向實體的路徑位置
- entry：進入點， JavsScript 模組的入口處
- output.filename：編譯打包後的檔案名稱。
先在 package.json 中 建立 build，這樣執行 npm run build 時會根據 webpack.config.js 中編譯後的會跑到 dist 資料夾中。
```
"scripts": {
    "test": "echo \"Error: no test specified\" && exit 1",
    "build": "webpack"
  }
```


建立幾個檔案
- public
- src
- src/index.js


npm 指令
script


### public 檔案放靜態檔
ex: 圖片、html
```
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project</title>
</head>

<body>
</body>

</html>
```

------------------------------------
### 安裝 css、scss
使用 css-loader
```
npm install sass-loader node-sass sass --save-dev
```

css
```
npm install style-loader css-loader --save-dev
```

webpack.config.js
```
 module: {
    rules: [
      {
        test: /\.css$/i,
        use: ['style-loader', 'css-loader'],
      },
      {
        test: /\.s[ac]ss$/i,
        use: [
          'style-loader',
          'css-loader',
          'sass-loader',
        ],
      },
 ]
 }
```

------------------------------------
### 安裝 babel 相關
```
npm install @babel/core @babel/preset-env @babel/preset-react babel-loader --save-dev
```

webpack.config.js
```
module: {
  rules: [
    {
      test: /\.(js)$/,
      exclude: /(node_modules)/,
      use: {
        loader: 'babel-loader',
        options: {
          presets: ["@babel/preset-env", "@babel/preset-react"],
        }
      }
    }
  ],
},
```

------------------------------------
### 安裝 server (模擬伺服器)
可以即時看到畫面的修改、變化，沒有使用的話，每次編譯之後都要另外使用模擬伺服器開啟
https://webpack.js.org/configuration/dev-server/
```
npm install webpack-dev-server --save-dev
```

-設定 webpack.config.js
```
module.exports = {
  entry: '/src/index.js',
  output: {
    path: path.resolve(__dirname, './dist'),
    publicPath: "/",
  },
  devServer: {
    static: {
      directory: path.join(__dirname, 'dist'),
    },
    compress: true,
    hot: true,
    port: 9000,
  },
}
```
>compress: 將所有的檔案壓縮成 .gzip 的檔案，這樣在開啟瀏覽器的速度會比較快速，但壓縮這行為會吃一些資源。
>hot: HMR (Hot Module Replacement)，修改 src 底下的資源時，也會同時更新模擬伺服器。

-設定 package.json
webpack-dev-server 使用 server，
mode development 開發模式(看有沒有用)，
open 執行模擬伺服器是否要自動開啟瀏覽器
```
"scripts": {
  "start": "webpack-dev-server --mode development --open",
},
```

------------------------------------
### 安裝 react 相關
1. 安裝
```
npm install react react-dom --save-dev
```


>簡化 HTML 的生成打包，代替原本 bundles 
```
npm install html-webpack-plugin --save-dev
```

webpack.config.js
```
const path = require('path');
const HtmlWebpackPlugin = require("html-webpack-plugin");

module.exports = {
  output: {
    path: path.resolve(__dirname, 'dist'),
    filename: 'bundle.js', // 原本打包生成的文件可以刪除---------------------------------可能不能要試試看
  },
  module: {
    //...
  },
  plugins: [
    new HtmlWebpackPlugin({
      template: "./public/index.html", // base html
    }),
  ],
};
```

2. 進入點的程式修改
```
import React from "react";
import ReactDOM from 'react-dom/client';
import "./all.scss";
import App from "./App";

const root = ReactDOM.createRoot(document.getElementById('root'));

root.render(
  <React.StrictMode>
    <App />
  </React.StrictMode>
);
```

3.建立 component
```
import React from "react";

function App() {
  return (
    <div className="App">
      1111111
    </div>
  );
}

export default App;
```



-----------------------------------------------------
參考
https://www.youtube.com/watch?v=fDWwaY3QMKk
https://medium.com/@tharinduit16/react-18-with-webpack-5-project-setup-steps-a93b4e1aaa3b
https://medium.com/%E5%89%8D%E7%AB%AF%E5%B0%8F%E7%A9%BA%E9%96%93/webpack-%E7%92%B0%E5%A2%83%E5%AE%89%E8%A3%9D%E8%88%87%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE-13d1d144b855